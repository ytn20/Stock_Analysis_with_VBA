# Stock_Analysis_with_VBA

# Overview of Project
The purpose of this project is to refactor the initial code used in the module to determine if refactoring it has any impact on the run time. 

# Results
The average run time for running the code for the year 2017 was 0.25 seconds after refactoring the code. The Green-energy stocks had positive yearly returns overall in 2017, however TERP was the only stock that had a negative return of -7.2%, being the lowest return in Green-energy stocks. The highest return in all stocks was DQ with 199.4% postive return in 2017. The top and bottom three stocks for the year and their returns are as follows:

**Highest Returns in 2017**
- DQ - 199.4%
- SEDG - 184.5%
- ENPH - 129.5%

**Lowest Returns in 2017**
- TERP - 7.2%
- AY - 8.9%
- RUN - 5.5%

![VBA_Challenge_2017](https://user-images.githubusercontent.com/100486461/180318765-71a77cdc-ee4c-454e-8345-4e1dea0a97ac.PNG)
![2017](https://user-images.githubusercontent.com/100486461/180317566-27c2179e-8552-42d5-aef3-a22eb5477ed1.PNG)

The average run time for running the code for the year 2018 was 0.50 seconds after refactoring the code. The Green-energy stocks had overall negative yearly returns in 2018, however ENPH and RUN were the only stocks that produced a positive of 81.9% and 84.0% respectively, being the highest return stocks in all Green-energy stocks. On the other hand the lowest return in all stocks was DQ with -62.6% postive return in 2018. This shows us that DQ is not a dependable stock that Steve's parent's can invest in. It would be advisible to consider some other stocks in the portfolio that can give greater returns each year. The top and bottom three stocks for the year and their returns are as follows:

**Highest Returns in 2018**
- RUN - 84.0%
- ENPH - 81.9%
- AY - -7.3%

**Lowest Returns in 2018**
- DQ - **-62.6%**
- JKS - **-60.5%**
- SPWR - **-44.6%**

![VBA_Challenge_2018](https://user-images.githubusercontent.com/100486461/180318780-5ccae9d2-d4d2-47ea-a9cb-e392c748b0a3.PNG)
![2018](https://user-images.githubusercontent.com/100486461/180318592-0f7fa98c-ebcb-4690-918f-76e8c8c8cbba.PNG)

# Summary
There are many advantages to refactoring the code some of which are increased efficiency. With a few modifications it took up less time to calculate the returns for each year. This saved time can be used for futhur analysis of the data. Another key advantage is it provides an opportunity to go over the code and see if there are any errors that could have been missed in the initial code. Though not many there are still a few disadvantages to refactoring code, one of which is it can be time consuming to come up with a way to make the code more effiecient and effective. 
